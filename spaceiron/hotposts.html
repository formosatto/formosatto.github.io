<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="/css/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="/css/font/css/font-awesome.min.css">
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@500&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Antonio:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/spaceiron.css">
    <title>Posts</title>
</head>
<html lang="zh-tw">
<body>

    <div id="load" w3-include-html="/src/includes/loading.html"></div>
    <div class="invisible" id="body">
        
        <!-- Navbar -->
        <div w3-include-html="/src/includes/navBar.html"></div>

        <div class="iron-body" id="iron-body">

            <!-- Sidebar -->
            <section w3-include-html="/src/includes/iron_sidebar.html" id="sidebar" class="sidebar-close"></section>
        
    
            <!-- Main  -->
            <main class="d-block">
    
                <!-- Title -->
                <h2 class="fw-bold m-5">
                    <img src="../src/img/icons/lightning.png" alt="lightning icon">
                    發燒文章
                </h2>
    
                <div class="row g-3 justify-content-center" id="post"> </div>
            </main>
    
    
    
        </div>

        <!-- Footer -->
        <footer w3-include-html="/src/includes/footer.html"></footer>

    </div>

</body>
</html>
<script src="https://www.w3schools.com/lib/w3.js"></script>
<script src="/js/conn.js"></script>
<script src="/js/main.js"></script>
<script src="/js/showMethods.js"></script>
<script src="/js/sidebar.js"></script>
<script src="/js/bootstrap/bootstrap.bundle.min.js"></script>
<script>

    
    new Load(() => {

        conn('/posts/?skip=0&limit=10')
        .then(res => {
            load_sidebar();
            load(res.data);
        })

    })

    function load(data){
        const row = document.getElementById('post');
        
        data.forEach( e => {
            let card = document.createElement('div')
            card.classList.add("col-auto");

            let content = '';
            if (e['content'].length > 100){
                content = e['content'].slice(0,100);
                content += ' . . . . . .';
            }else{
                content = e['content'];
            }

            card.innerHTML = `
                <div class="card h-100">
                    <div class="card-body h-100"">
                        <h5 class="card-title border-bottom p-2">${e['title']}</h5>
                        <p class="card-text" style="height: 80px;">${content}</p>
                        <a href="/spaceiron/posts?id=${e['id']}" class="card-link text-primary">Read more</a>
                    </div>
                    <div class="card-footer">
                        <i class="fa fa-clock-o"></i>
                        ${e['post_time'].slice(0,10)}
                    </div>
                </div>
            `
            row.appendChild(card);
        });
    }

</script>